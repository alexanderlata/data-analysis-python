# Проверка гипотезы о математическом ожидании нормального распределения

**Инструкции к выполнению:**

1. Для каждой задачи сформулируйте нулевую и альтернативную гипотезы
2. Определите тип альтернативы (двусторонняя / левосторонняя / правосторонняя)
3. Проведите t-тест с помощью `scipy.stats.ttest_1samp()`
4. Постройте доверительный интервал для математического ожидания
5. Сформулируйте содержательный вывод в контексте задачи

---

## Упражнение 1: Время рассмотрения дел в суде

**Уровень сложности:** ⭐ Базовый

Согласно регламенту, среднее время рассмотрения гражданских дел в районном суде не должно превышать 60 дней. Для проверки эффективности работы суда взята случайная выборка из 18 завершённых дел.

**Данные** (время рассмотрения в днях):

```python
case_duration = [58, 72, 65, 55, 68, 61, 75, 63, 59, 70,
                 64, 67, 56, 71, 62, 66, 69, 57]
```

**Задание:** Проверить, соблюдается ли регламент на уровне значимости α = 0.05.

---

## Упражнение 2: Качество топлива на АЗС

**Уровень сложности:** ⭐ Базовый

Октановое число бензина марки АИ-95 должно составлять ровно 95. Инспекция Роспотребнадзора проверила качество топлива на автозаправочной станции, взяв 12 проб.

**Данные** (октановое число):

```python
octane = [94.8, 95.2, 94.5, 95.1, 94.9, 95.3,
          94.7, 95.0, 94.6, 95.2, 94.8, 95.1]
```

**Задание:** Проверить соответствие топлива стандарту на уровне значимости α = 0.05.

---

## Упражнение 3: Эффективность нового лекарства

**Уровень сложности:** ⭐ Базовый

Стандартное лекарство снижает артериальное давление в среднем на 15 мм рт. ст. Фармацевтическая компания разработала новый препарат и утверждает, что он эффективнее стандартного. Проведено клиническое испытание на 20 пациентах.

**Данные** (снижение давления в мм рт. ст.):

```python
pressure_reduction = [16, 18, 14, 19, 17, 15, 20, 16, 18, 17,
                      19, 15, 18, 16, 17, 20, 14, 19, 16, 18]
```

**Задание:** Проверить, действительно ли новый препарат эффективнее стандартного (α = 0.01).

---

## Упражнение 4: Время реагирования полиции

**Уровень сложности:** ⭐⭐ Средний

Норматив времени прибытия полицейского патруля на вызов составляет 8 минут. Начальник районного управления полиции заявляет, что в их районе время реагирования лучше норматива. Для проверки собраны данные по 25 вызовам.

**Данные** (время прибытия в минутах):

```python
response_time = [7.2, 8.1, 6.5, 7.8, 7.0, 8.3, 6.9, 7.5, 7.1, 8.0,
                 6.8, 7.4, 7.9, 6.7, 7.3, 8.2, 7.0, 7.6, 6.6, 7.8,
                 7.2, 8.0, 6.9, 7.4, 7.1]
```

**Задание:**

1. Проверить утверждение начальника на уровне значимости α = 0.05
2. Построить 95% и 99% доверительные интервалы для среднего времени реагирования
3. Объяснить, как изменяется ширина доверительного интервала при увеличении уровня доверия

---

## Упражнение 5: Размер штрафов за нарушение ПДД

**Уровень сложности:** ⭐⭐ Средний

По данным ГИБДД, средний штраф за нарушение правил дорожного движения в регионе составляет 2500 рублей. Журналист-расследователь предполагает, что в столице штрафы выше среднего по региону. Он собрал данные о 30 штрафах, выписанных в Москве.

**Данные** (размер штрафа в рублях):

```python
fines = [2600, 2450, 2800, 2550, 2700, 2400, 2900, 2500, 2650, 2750,
         2480, 2820, 2580, 2700, 2450, 2850, 2520, 2680, 2600, 2750,
         2400, 2900, 2550, 2720, 2480, 2800, 2600, 2650, 2500, 2780]
```

**Задание:**

1. Проверить гипотезу журналиста на уровне значимости α = 0.05
2. Рассчитать мощность теста при условии, что истинное среднее равно 2800 рублей

---

## Упражнение 6: Содержание алкоголя в крови водителей

**Уровень сложности:** ⭐⭐ Средний

Допустимая норма содержания алкоголя в крови водителя составляет 0.3 промилле. При проверке водителей в ночное время сотрудники ГИБДД получили следующие измерения.

**Данные** (содержание алкоголя в промилле):

```python
alcohol = [0.28, 0.35, 0.22, 0.41, 0.31, 0.18, 0.45, 0.29, 0.38, 0.24,
           0.33, 0.27, 0.42, 0.30, 0.36]
```

**Задание:**

1. Проверить, превышает ли среднее содержание алкоголя допустимую норму (α = 0.01)
2. Построить 99% доверительный интервал
3. Объяснить связь между результатом проверки гипотезы и положением нормы относительно доверительного интервала

---

## Упражнение 7: Зарплата разработчиков в IT-компании

**Уровень сложности:** ⭐⭐⭐ Продвинутый

HR-отдел крупной IT-компании заявляет, что средняя зарплата разработчиков составляет 180 000 рублей. Профсоюз считает, что реальная зарплата ниже заявленной. Проведён анонимный опрос 35 сотрудников.

**Данные** (зарплата в тысячах рублей):

```python
salaries = [175, 182, 168, 179, 185, 172, 178, 190, 165, 181,
            176, 188, 170, 183, 174, 179, 186, 169, 177, 184,
            173, 180, 187, 171, 178, 182, 175, 189, 166, 180,
            177, 185, 172, 181, 176]
```

**Задание:**

1. Проверить утверждение профсоюза на уровне значимости α = 0.05
2. Рассчитать минимальный объём выборки, необходимый для обнаружения разницы в 10 000 рублей с мощностью 80%
3. Построить гистограмму распределения зарплат с указанием выборочного среднего, заявленного значения и доверительного интервала

---

## Упражнение 8: Время доставки посылок

**Уровень сложности:** ⭐⭐⭐ Продвинутый

Норматив времени доставки посылок курьерской службой составляет 3 дня. Логистическая компания хочет проверить, соблюдается ли данный норматив.

**Данные** (время доставки в днях):

```python
delivery_time = [3.2, 2.8, 3.5, 2.9, 3.1, 3.4, 2.7, 3.3, 3.0, 3.2,
                 2.8, 3.6, 3.1, 2.9, 3.4, 3.0, 3.2, 2.8, 3.3, 3.1]
```

**Задание:**

1. Проверить гипотезу о соблюдении норматива при трёх уровнях значимости: α = 0.10, α = 0.05, α = 0.01
2. Объяснить, почему результат проверки может различаться при разных уровнях значимости
3. Определить минимальный уровень значимости α, при котором нулевая гипотеза будет отвергнута

---

## Упражнение 9: Моделирование ошибок I и II рода

**Уровень сложности:** ⭐⭐⭐ Продвинутый

Проведите компьютерное моделирование для понимания связи между ошибками I и II рода в статистических тестах.

**Задание:**

1. Сгенерируйте 1000 выборок объёма n = 20 из нормального распределения N(100, 15²)
2. Для каждой выборки проверьте гипотезу H₀: μ = 100 при α = 0.05
3. Подсчитайте долю ложных отклонений нулевой гипотезы (ошибка I рода). Сравните с теоретическим значением α
4. Повторите моделирование, генерируя данные из N(105, 15²), при этом проверяя ту же гипотезу H₀: μ = 100
5. Подсчитайте долю случаев, когда ложная гипотеза H₀ не была отвергнута (ошибка II рода)
6. Вычислите эмпирическую мощность теста (1 − β)
7. Постройте визуализацию результатов

---

## Упражнение 10: Анализ дорожно-транспортных происшествий

**Уровень сложности:** ⭐⭐⭐⭐ Исследовательский

По данным статистики, среднее число пострадавших в одном ДТП по России составляет 1.8 человека. Исследователь собрал данные о 40 ДТП, произошедших в крупном мегаполисе.

**Данные** (число пострадавших):

```python
casualties = [2, 1, 3, 2, 1, 4, 2, 1, 2, 3, 1, 2, 2, 1, 3, 2, 1, 2, 4, 2,
              1, 3, 2, 2, 1, 2, 3, 1, 2, 2, 1, 3, 2, 2, 1, 2, 3, 2, 1, 2]
```

**Задание:**

1. Рассчитайте описательные статистики (среднее, стандартное отклонение, медиану, минимум, максимум)
2. Проверьте, отличается ли среднее число пострадавших в мегаполисе от общероссийского показателя
3. Постройте 90%, 95% и 99% доверительные интервалы. Проанализируйте, как изменяется положение общероссийского показателя относительно этих интервалов
4. Проведите анализ чувствительности: определите, при каких уровнях значимости (α = 0.10, 0.05, 0.01, 0.001) нулевая гипотеза будет отвергнута
5. Создайте комплексную визуализацию, включающую:
   - гистограмму распределения числа пострадавших
   - график доверительных интервалов
   - график анализа чувствительности
6. Сформулируйте содержательные выводы и практические рекомендации для дальнейшего исследования

---

## Критерии оценивания

| Критерий | Баллы |
|----------|-------|
| Правильная формулировка гипотез | 1 |
| Корректный выбор типа альтернативы | 1 |
| Правильное применение t-теста | 2 |
| Построение доверительного интервала | 1 |
| Содержательная интерпретация результатов | 2 |
| Качество визуализации (где требуется) | 1 |
| Дополнительные задания | 2 |
| **Итого** | **10** |

---

## Справочные материалы

### Функции scipy.stats для t-теста

```python
from scipy import stats

# Двусторонний тест: H₁: μ ≠ μ₀
t_stat, p_value = stats.ttest_1samp(data, popmean=mu_0)

# Правосторонний тест: H₁: μ > μ₀
t_stat, p_value = stats.ttest_1samp(data, popmean=mu_0, alternative='greater')

# Левосторонний тест: H₁: μ < μ₀
t_stat, p_value = stats.ttest_1samp(data, popmean=mu_0, alternative='less')
```

### Доверительный интервал

```python
import numpy as np
from scipy import stats

mean = np.mean(data)
se = stats.sem(data)  # стандартная ошибка среднего
n = len(data)

# 95% доверительный интервал
ci = stats.t.interval(confidence=0.95, df=n-1, loc=mean, scale=se)
```

### Правило принятия решения

- Если p-value < α → отвергаем H₀
- Если p-value ≥ α → не отвергаем H₀


---

## Шаблон решения задачи

Используйте этот шаблон для оформления решения каждого упражнения.

---

### Упражнение №___: _________________________________

**Шаг 1. Импорт библиотек и ввод данных**

```python
import numpy as np
from scipy import stats

# Данные задачи
data = np.array([___])

# Параметры
mu_0 = ___      # гипотетическое значение μ
alpha = ___     # уровень значимости
```

**Шаг 2. Формулировка гипотез**

```
H₀: μ ___ ___   (нулевая гипотеза — словами: ___________________________)

H₁: μ ___ ___   (альтернативная гипотеза — словами: ____________________)

Тип альтернативы: ☐ двусторонняя  ☐ левосторонняя  ☐ правосторонняя
```

**Шаг 3. Описательные статистики**

```python
n = len(data)
mean = np.mean(data)
std = np.std(data, ddof=1)
se = stats.sem(data)

print(f"Объём выборки: n = {n}")
print(f"Выборочное среднее: x̄ = {mean:.4f}")
print(f"Выборочное станд. откл.: s = {std:.4f}")
print(f"Станд. ошибка среднего: SE = {se:.4f}")
```

Результаты:

| Статистика | Значение |
|------------|----------|
| n          | ___      |
| x̄          | ___      |
| s          | ___      |
| SE         | ___      |

**Шаг 4. Проведение t-теста**

```python
# Выберите нужный вариант alternative: 'two-sided', 'less', 'greater'
t_stat, p_value = stats.ttest_1samp(data, popmean=mu_0, alternative='___')

print(f"t-статистика: t = {t_stat:.4f}")
print(f"p-значение: p = {p_value:.4f}")
```

Результаты:

| Показатель | Значение |
|------------|----------|
| t-статистика | ___    |
| p-value      | ___    |

**Шаг 5. Построение доверительного интервала**

```python
confidence = 1 - alpha  # уровень доверия
ci = stats.t.interval(confidence=confidence, df=n-1, loc=mean, scale=se)

print(f"{int(confidence*100)}% доверительный интервал: ({ci[0]:.4f}, {ci[1]:.4f})")
```

Результат: ___% ДИ для μ: ( ___ , ___ )

**Шаг 6. Принятие статистического решения**

```
Сравнение p-value с α:

p-value = ___  ☐ <  ☐ ≥  α = ___

Решение: ☐ Отвергаем H₀    ☐ Не отвергаем H₀
```

**Шаг 7. Содержательный вывод**

```
На уровне значимости α = ___ :

☐ Получены статистически значимые данные в пользу того, что _______________
  ________________________________________________________________________

☐ Не получено достаточных оснований для вывода о том, что _________________
  ________________________________________________________________________
```

**Шаг 8. Дополнительный анализ (если требуется)**

```python
# Место для дополнительных расчётов и визуализации
___
```

---

## Пример заполненного шаблона

### Упражнение №2: Качество топлива на АЗС

**Шаг 1. Импорт библиотек и ввод данных**

```python
import numpy as np
from scipy import stats

# Данные задачи
data = np.array([94.8, 95.2, 94.5, 95.1, 94.9, 95.3,
                 94.7, 95.0, 94.6, 95.2, 94.8, 95.1])

# Параметры
mu_0 = 95       # стандартное октановое число АИ-95
alpha = 0.05    # уровень значимости
```

**Шаг 2. Формулировка гипотез**

```
H₀: μ = 95    (нулевая гипотеза: октановое число соответствует стандарту)

H₁: μ ≠ 95    (альтернативная гипотеза: октановое число не соответствует стандарту)

Тип альтернативы: ☑ двусторонняя  ☐ левосторонняя  ☐ правосторонняя
```

**Шаг 3. Описательные статистики**

```python
n = len(data)
mean = np.mean(data)
std = np.std(data, ddof=1)
se = stats.sem(data)

print(f"Объём выборки: n = {n}")
print(f"Выборочное среднее: x̄ = {mean:.4f}")
print(f"Выборочное станд. откл.: s = {std:.4f}")
print(f"Станд. ошибка среднего: SE = {se:.4f}")
```

Результаты:

| Статистика | Значение |
|------------|----------|
| n          | 12       |
| x̄          | 94.9333  |
| s          | 0.2674   |
| SE         | 0.0772   |

**Шаг 4. Проведение t-теста**

```python
t_stat, p_value = stats.ttest_1samp(data, popmean=mu_0, alternative='two-sided')

print(f"t-статистика: t = {t_stat:.4f}")
print(f"p-значение: p = {p_value:.4f}")
```

Результаты:

| Показатель   | Значение |
|--------------|----------|
| t-статистика | -0.8660  |
| p-value      | 0.4052   |

**Шаг 5. Построение доверительного интервала**

```python
confidence = 0.95
ci = stats.t.interval(confidence=confidence, df=n-1, loc=mean, scale=se)

print(f"95% доверительный интервал: ({ci[0]:.4f}, {ci[1]:.4f})")
```

Результат: 95% ДИ для μ: ( 94.7635 , 95.1032 )

**Шаг 6. Принятие статистического решения**

```
Сравнение p-value с α:

p-value = 0.4052  ☑ ≥  α = 0.05

Решение: ☐ Отвергаем H₀    ☑ Не отвергаем H₀
```

**Шаг 7. Содержательный вывод**

```
На уровне значимости α = 0.05:

☑ Не получено достаточных оснований для вывода о том, что октановое число 
  бензина на данной АЗС отличается от стандарта 95. Топливо можно считать 
  соответствующим требованиям.

Дополнительно: значение μ₀ = 95 входит в 95% доверительный интервал 
(94.76, 95.10), что согласуется с результатом теста.
```